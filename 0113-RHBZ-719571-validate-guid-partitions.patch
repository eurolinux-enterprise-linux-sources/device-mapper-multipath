---
 kpartx/gpt.c |    9 +++++++++
 1 file changed, 9 insertions(+)

Index: multipath-tools/kpartx/gpt.c
===================================================================
--- multipath-tools.orig/kpartx/gpt.c
+++ multipath-tools/kpartx/gpt.c
@@ -358,6 +358,15 @@ is_gpt_valid(int fd, uint64_t lba,
 		return 0;
 	}
 
+	/* Check that sizeof_partition_entry has the correct value */
+	if (__le32_to_cpu((*gpt)->sizeof_partition_entry) != sizeof(gpt_entry)) {
+		// printf("GUID partition entry size check failed.\n");
+		free(*gpt);
+		*gpt = NULL;
+		return 0;
+	}
+
+
 	if (!(*ptes = alloc_read_gpt_entries(fd, *gpt))) {
 		free(*gpt);
 		*gpt = NULL;
